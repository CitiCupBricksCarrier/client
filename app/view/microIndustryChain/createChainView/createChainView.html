<link rel="stylesheet" href="view/microIndustryChain/createChainView/bootstrap-colorpicker.css">

<div id="topElement" ng-mousedown="hideAllBoard()" onselectstart="return false;">

    <div>
        <canvas id="netBackground" style="left: 0; top: 0;"></canvas>
        <canvas id="connectionBackground" style="left: 0; top: 0;"></canvas>
        <canvas id="animeBackground" style="left: 0; top: 0;"></canvas>
        <canvas id="canvas" data-toggle="context" data-target="#canvas-menu" style="left: 0; top: 0;"></canvas>
    </div>

    <div id="nodeDiv">
    </div>

    <div id="leftToolBar">
        <div class="leftToolBarBlock">
            <button class="btn btn-default" ng-click="showAddNodeBoard()">add</button>
            <button class="btn btn-default" ng-click="addEmptyNode()">addE</button>
            <button class="btn btn-default" data-popover="popover" data-trigger="hover" title="Dismissible popover" data-content="And here's some amazing content. It's very engaging. Right?">popover</button>
        </div>

        <ul class="nav nav-tabs small">
            <li class="active"><a href="#nodeHistory" data-toggle="tab">节点</a></li>
            <li><a href="#connectionHistory" data-toggle="tab">联系</a></li>
        </ul>
        <div class="historyBlock">
            <div class="tab-content">
                <div class="tab-pane fade in active" id="nodeHistory">
                    <div class="historyBlockCell" ng-mousedown="setMouseDownNodeID(id)" ng-dblclick="dblclickNodeHistoryBlockCell(id)"
                         ng-repeat="id in nodeIDList" data-toggle="context" data-target="#node-menu">
                        <div style="color:{{nodeList[id].nodeColor}}; font-weight:bold;">● {{nodeList[id].nodeName}}</div>
                        <button ng-click="deleteNodeByHistory(id)" class="btn-sm btn-default">删除</button>
                    </div>
                </div>
                <div class="tab-pane fade" id="connectionHistory">
                    <div class="historyBlockCell small" ng-mousedown="setMouseDownConnectionIndex($index)" ng-dblclick="dblclickConnectionHistoryBlockCell($index)"
                         ng-repeat="connection in connectionList" data-toggle="context" data-target="#connection-menu">
                        <div>
                            由<span style="color:{{nodeList[connection.begin].nodeColor}}; font-weight:bold;"> ● {{nodeList[connection.begin].nodeName}} </span>
                            至<span style="color:{{nodeList[connection.end].nodeColor}}; font-weight:bold;"> ● {{nodeList[connection.end].nodeName}} </span>
                            :<span style="font-weight:bold"> {{connection.fund}} </span>
                            万元
                        </div>
                        <button ng-click="deleteConnectionByHistory($index)" class="btn-sm btn-default">删除</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="topToolBar">

    </div>

</div>



<div id="addNodeBoard" ng-show="isAddingNode" style="left: 0; top: 0;">
    <div>
        <p>股票代码</p>
        <input id="addNodeStockInput" class="form-control" type="text" placeholder="请输入股票代码..." onkeyup="this.value=this.value.replace(/[^0-9]/g,'')" onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">
    </div>
    <a ng-click="showMoreAddNodeOptions = !showMoreAddNodeOptions">自定义...</a>
    <div ng-show="showMoreAddNodeOptions">
        <div>
            <p>节点名</p>
            <input id="addNodeNameInput" class="form-control" type="text" placeholder="请输入节点名...">
        </div>
        <div>
            <p>角色</p>
            <input id="addNodeRoleInput" class="form-control" type="text" placeholder="请输入节点角色...">
        </div>
        <div>
            <p>标记颜色</p>
            <div id="addNodeCP" class="input-group">
                <input id="addNodeColorInput" class="form-control" type="text" value="#00AABB">
                <span class="input-group-addon"><i></i></span>
            </div>
        </div>
    </div>
    <div class="row center-block">
        <button ng-click="hideAddNodeBoard()" class="btn btn-default">取消</button>
        <button ng-click="addNewNode()" class="btn btn-default">确认添加</button>
    </div>
</div>

<div id="editNodeBoard" ng-show="isEdittingNode"  style="left: 0; top: 0;">
    <div>
        <p>股票代码</p>
        <input id="editNodeStockInput" class="form-control" type="text" placeholder="请输入股票代码..." onkeyup="this.value=this.value.replace(/[^0-9]/g,'')" onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">
    </div>
    <a ng-click="showMoreEditNodeOptions = !showMoreEditNodeOptions">自定义...</a>
    <div ng-show="showMoreEditNodeOptions">
        <div>
            <p>节点名</p>
            <input id="editNodeNameInput" class="form-control" type="text" placeholder="请输入节点名...">
        </div>
        <div>
            <p>角色</p>
            <input id="editNodeRoleInput" class="form-control" type="text" placeholder="请输入节点角色...">
        </div>
        <div>
            <p>标记颜色</p>
            <div id="editNodeCP" class="input-group">
                <input id="editNodeColorInput" class="form-control" type="text" value="#00AABB">
                <span class="input-group-addon"><i></i></span>
            </div>
        </div>
    </div>
    <div class="row center-block">
        <button ng-click="hideEditNodeBoard()" class="btn btn-default">取消</button>
        <button ng-click="editNode()" class="btn btn-default">确认修改</button>
    </div>
</div>

<div id="addConnectionBoard" ng-show="isAddingConnection"  style="left: 0; top: 0;">
    <div>
        <p>资金往来</p>
        <input id="addConnectionFundExchangeInput" class="form-control" type="number" placeholder="请输入资金量(万元)...">
    </div>
    <div class="row center-block">
        <button ng-click="hideAddConnectionBoard()" class="btn btn-default">取消</button>
        <button ng-click="addNewConnection()" class="btn btn-default">确认修改</button>
    </div>
</div>

<div id="editConnectionBoard" ng-show="isEdittingConnection"  style="left: 0; top: 0;">
    <div>
        <p>资金往来</p>
        <input id="editConnectionFundExchangeInput" class="form-control" type="number" placeholder="请输入资金量(万元)...">
    </div>
    <div class="row center-block">
        <button ng-click="hideEditConnectionBoard()" class="btn btn-default">取消</button>
        <button ng-click="editConnection()" class="btn btn-default">确认修改</button>
    </div>
</div>

<div id="node-menu" style="position: fixed">
    <ul class="dropdown-menu">
        <li ng-click="showEditNodeBoard()"><a>修改</a></li>
        <li class="divider"></li>
        <li ng-click="deleteNodeByMenu()"><a style="color: indianred">删除</a></li>
    </ul>
</div>

<div id="connection-menu" style="position: fixed">
    <ul class="dropdown-menu">
        <li ng-click="showEditConnectionBoard()"><a>修改</a></li>
        <li class="divider"></li>
        <li ng-click="deleteConnectionByHistory(mouseDownConnectionIndex)"><a style="color: indianred">删除</a></li>
    </ul>
</div>

<div id="canvas-menu" style="position: fixed">
    <ul class="dropdown-menu">
        <li ng-click="showAddNodeBoard()"><a>增加新的节点...</a></li>
        <li ng-click="addEmptyNode()"><a>增加空节点</a></li>
        <li class="divider"></li>
        <li ng-click="undo()"><a>撤销</a></li>
        <li ng-click="redo()"><a>重做</a></li>
    </ul>
</div>

<script src="view/microIndustryChain/createChainView/bootstrap-colorpicker.js"></script>
<script>
    $(function () {
        // Basic instantiation:
        $('#addNodeCP').colorpicker();
        $('#editNodeCP').colorpicker();


        $("[data-popover='popover']").popover({
//            title: title(),
            delay:{show:500, hide:100},
        });
    });
</script>
<link rel="stylesheet" href="view/microIndustryChain/createChainView/createChainView.css">